#ifndef HMAP_RAND_H
#define HMAP_RAND_H

#include <stdint.h>

typedef struct {
	int32_t tap;
	int32_t feed;
	int64_t vec[607];
} rand_source;

// rand_source_seed seeds the rand_source.
void rand_source_seed(rand_source *rng, int64_t seed);

// rand_source_uint64 returns a random uint64_t.
uint64_t rand_source_uint64(rand_source *rng);

// rand_source_int64 returns a random int64_t.
int64_t rand_source_int64(rand_source *rng);

// rand_seed seeds the global rand_source.
void rand_seed(int64_t seed);

// rand_uint64 returns a random uint64_t using the global source.
uint64_t rand_uint64(void);

// rand_int64 returns a random int64_t using the global source.
int64_t rand_int64(void);

// rand_seed_once initialize the global rand once with a seed based
// off of the wall time and processor clock time.
void rand_seed_once(void);

// RAND_SOURCE_INITIALIZER statically initializes a rand_source with a seed of 0.
#define RAND_SOURCE_INITIALIZER (rand_source) {                                                     \
		.tap = 0,                                                                                   \
		.feed = 334,                                                                                \
		.vec = {                                                                                    \
			-115967349745338974,  -3738206981343068541, 8184272345691605879,  -3669625146990347732, \
			-4177320529392763226, 6950235086276551548,  7162630727644501935,  6766047935948610179,  \
			-8341260178672900801, -7577853918693201407, 4239692720998690069,  -5580442752605875372, \
			822154141716589010,   -3921774665304722567, 9072789631596281187,  -742494571528117558,  \
			-3320758401503386630, 6002165885820238250,  -9028998821974867843, 4763914007379491931,  \
			-7891579379577030764, 2472551155413747361,  711033904483398783,   -5070325689564168300, \
			-679586957289375132,  -1439801418076178166, 7855138210710162249,  -2568729239842983141, \
			7267959748048724689,  5698760826874497256,  -1065696302923706669, 7991068771364885829,  \
			-4520816025182547726, -4885215325489564852, -2262352599706607653, 8446727746880850989,  \
			-2873469776081901411, 978459085807872692,   8270609860278894960,  966915990543685262,   \
			8330178657957417529,  2238538279440842195,  -1576301677263354816, 5483524863902250842,  \
			-5968074044770913879, 1770606162977765155,  -3231730123829249344, -2672818075830828918, \
			8819599690028205320,  -8999707924485783864, 7748149953423522266,  2009834323828058629,  \
			-1164459029227694435, 1932939728385411180,  -8993662787334582856, -6400737130465620670, \
			-1630820961508795978, -7163148521899393476, 7762042542154872013,  1084421212411791078,  \
			6821104831190593244,  -3051392560939106666, -2151008572401164692, 2347592409708199799,  \
			5688404575357120272,  7847629714133416644,  6892278714910603404,  9084283644533930188,  \
			-6630299797162893471, 8975459530997041832,  3821542915340787526,  -5487644683729935161, \
			-2093359865876753271, 5661261155653683162,  -2052345707234519746, 7299267287937698267,  \
			4050246206607220961,  -7952656438509426198, 4698738424680932098,  1089042015452821912,  \
			-1476099413408181178, 1188261662649839263,  2443518675703829387,  -5502821824978454541, \
			-1233584568708316597, -7356042825726796052, 8052338207513803242,  -2873115281884823889, \
			-241085310592618290,  -1459620168295735499, 3223891297539652768,  7011087736098953883,  \
			201197908548425616,   1604118379584411155,  7636406930251226940,  -7441773350960235030, \
			-6280052513577753718, -8121100491125445735, 1020844605662107591,  5186504011515172963,  \
			-5474067987620162454, 8235021504275132124,  6386067177309783482,  -4494809392545555070, \
			2940402972583721453,  1191580738194563244,  -3172346746036158608, -2074932987170954614, \
			1857368814179176458,  -7289029282848393524, -4235214681610748352, 8778060539271143316,  \
			-4376681993950328114, -772469037886118053,  3571862848161335858,  7938320316544824235,  \
			1310085491930736025,  -8105786953636876507, 1689953658415593761,  -1347685628494825034, \
			9005326597259891852,  -2886036738006604211, 1086179826078600363,  -5810555771136677354, \
			-7786897139238660200, -5928034609498352229, 22676213247980457,    8444835951276132226,  \
			1433637911999899519,  769618341634424515,   -6911039602041327578, 5369501898276481622,  \
			4130280448043608406,  -4484746499345462986, 5441672030351989836,  -2942717229478035877, \
			-8880336854494399043, -2246890946459453663, -4053211995851668262, 5103144926989310728,  \
			-678684406355411877,  -4211524834951783321, 8718719442099737321,  945199632633837959,   \
			6799070285488765870,  -2585097912532550391, 3211398632140339168,  -8586722678701215096, \
			-8529751394580212601, -844482616676699813,  6676680656186589019,  3230522943165879797,  \
			6264684739691816181,  6829121766435501738,  -9090282184020561704, -6590871134176617824, \
			6479788291794249273,  -5039717586675060353, -3513186530683534426, 741785392692420925,   \
			2229877640156256075,  -4955589665703246972, -8754520148988989830, 4286813750930776281,  \
			-8783424102709018946, -4397671055888489663, 6437912185503702350,  -1728380210431376106, \
			5554772267962582326,  -4423605510525729980, -7388515575582584843, 6891088991933005427,  \
			664986225392873074,   -5910635054095417990, 3479459609348021847,  -6465302720780558412, \
			-2805787729179650060, 5777344525038369410,  6474010414960451084,  6217340669054015804,  \
			-9163749356522391524, -2292517059757739153, 6410187950498581543,  -6302272043916568078, \
			-6723978104047155825, 1555393264378652271,  3253552047530417156,  -3533273163449647954, \
			8864397454928915225,  1725476788040200816,  -2293589803713192214, -1321594597227303259, \
			5242569600399441916,  53660699713643223,    3040776454752845854,  185704525924736915,   \
			8000340041396240929,  9158946794780139301,  4780151930570023698,  9063394817910908278,  \
			6189085096637303555,  8600139161219762830,  -3751480224818062977, 4216143906841348215,  \
			5692666068649091458,  1363569624246760596,  3022776019835433992,  -6534067969543639778, \
			1987503234106261142,  -2564283625392529671, 1862345879831002496,  -7892566546662338898, \
			-2075468854027390777, 6479022829115411557,  67473952516877360,    -5620010191571457293, \
			-4646932003060727819, -5996762332744373636, -3829220861958638446, -8330426891138316795, \
			-9223206752958372289, 4170203188771891733,  -3734730063882675604, 1417289062151727082,  \
			2324941603210498590,  -4669919164375555343, -6986663659792131328, 1046772159378060654,  \
			-910191780995691899,  5175874225867228905,  692135327266841470,   -5496950010245991118, \
			-7777682007509576012, 3594901093475268274,  -287912443336529054,  4273435073339482727,  \
			8664171827102100745,  -1886638574475993248, -8854159741155735955, 4713520049773705067,  \
			6527702823727612227,  719496202382899886,   -7514891806925765751, 3978668411741435695,  \
			-5953866634859488056, 452545301798652246,   6266741658888158972,  176052340192315726,   \
			-2664111753933147896, -7344576465494895310, 8449534801169658368,  5432273530526021634,  \
			-8126259702323828601, 8317950517864824865,  -4918278571721433252, -836521771386582288,  \
			-5374174656277545201, -3472399563459621402, 7528245188249873486,  2013337094229178916,  \
			-4286612835987362489, -4160674927006048238, 1259329430057186185,  7748410751136963002,  \
			732318857496538457,   6006802135709575133,  3739471645651697322,  -2905667686424571891, \
			-4113351717109033554, -3968483130638593792, 3209595456441112746,  -159219379100603969,  \
			-1478046764388717464, -7803257084481220212, 1034637635191826635,  -7048800965915440816, \
			-1571070373904494417, -99111787582305695,   8306529618610811915,  404806475519566894,   \
			4405654170534147557,  -4542825061580013978, 3746793256928785384,  -7354485292598131521, \
			-8238723457208595496, -8591788207331415998, 4274058908301025023,  4100734746395178295,  \
			3197562580659303611,  -2810428187466698955, -9078077568657534056, -1931556543246341676, \
			-8880990584351054282, -1888871729528642966, 225835508098538432,   -6969046503877228688, \
			-5375346965032525301, 1130409465754257818,  -7622065524009557825, 2153210363296430821,  \
			-26162160237004177,   -8061320090159801943, 7780160686335395666,  5963947799885211739,  \
			-5362880474487478545, 3224969032693661649,  6781731761925100850,  -5368694991921693609, \
			-3726302265015060332, -3061378208922570218, 5821566059155231881,  7646915502318285188,  \
			97639677927880992,    -227796159766034654,  8244290593545515296,  4264033584351104738,  \
			3615728052694554488,  -8351266036178189081, -3600932186754552585, 8245460455491187853,  \
			8124010563852538439,  1289104570058905188,  3955110041790253576,  -3194964462412641237, \
			5778914742346342027,  -8469403146496123179, 1473491143351630770,  5649513531025484272,  \
			4276072738610570857,  1452167995902605199,  1893807027882140874,  2651257641536837752,  \
			5636222557099579515,  8326896963866600264,  -339821778760735388,  8338848616939207931,  \
			-818531515879931120,  2579782177378120662,  5662058973973761851,  -6862906591297515658, \
			6364596583012669441,  -3586283590788018968, 1717667904532051265,  -5248137868353401152, \
			-5684162816324273061, -7826757571932049097, 1209139817757463833,  -5532196582755338844, \
			-3019292930539104418, -3694776044250196565, -1388729112564657544, -4919348860436335794, \
			-3838052838061377248, -7984531486104433957, 4231814939129802822,  -2072310166861922140, \
			-362619954472572299,  -2679394445826053636, 1124091833075269004,  4923815048226941267,  \
			5807319958623622662,  8722894829126855884,  2763175014462005930,  5769940124071763222,  \
			-2127580798779445389, -2637342203814751930, 5780941968056563361,  -2443489330735140406, \
			-2641900553622257657, 7794856469738227025,  5397491821351627760,  -2659414991555664233, \
			6713133700935328449,  8867659513107670191,  6364631455463442621,  8539074478203380434,  \
			2734688455733475001,  7406760840836311269,  6623157002606571143,  -5504757132694300084, \
			3961696041462237169,  -1573584562224583421, 3108619062376938414,  4877217934643181826,  \
			734360966155067936,   1667613296397529445,  -804557603105448612,  -7862241340180827913, \
			-9212029610069230348, 4718575538790695716,  -8727618246332068977, -3467302942445544365, \
			-1146083686946874948, -4754167343513852940, -1556671977125128952, -1131296593933711336, \
			6060918365700029406,  3014409171438782894,  2090190722070657086,  -169469610023768263,  \
			6312901958408189246,  1552751300117068843,  -729263051575865390,  2689647896068644969,  \
			-4937184619316615504, 1236192034071117096,  -1430150326918477212, -8807185287907651712, \
			183856286672338515,   -4886124732450193721, 923415002687529613,   -8975307586403934764, \
			2900375741599792250,  3285459096123376687,  3259944074231694653,  278762105949572054,   \
			3337816709070105638,  -4144474568495340826, -5260946529342924616, 698226140318431429,   \
			4333508506612417385,  6992627583907063534,  5829279934585001662,  2876843065374896523,  \
			152680133287808835,   5110430811408018464,  -7520259123296998849, -4956337628755375829, \
			-4985729110178814753, -6744869852678809772, 7263469369221706259,  2243089343108210081,  \
			-3948016494648210957, -5287278859058596826, -36965683634308796,   -6370512943319706781, \
			5998982864570558538,  1459064968763737499,  -1164098519714419632, -2681943039747984194, \
			5602930253769634257,  -5942299251188909623, -3846868869401856153, 5672077930397353315,  \
			5199876951306163836,  8715904890298230495,  -4594278719962986057, 1266445578144686654,  \
			-3217213369711369964, 3817463813645160584,  -6721587920932615139, -5110424704484921859, \
			-906508005258974734,  -4742507030598559969, -7200688779520798816, -1434938271990941123, \
			-7329610831545625050, -1954412286768879364, 2683256251253357024,  -4998314025078045093, \
			3723690714264654389,  -8882525868366234318, 607571786350755515,   -4210904385543914817, \
			-2875168057124648271, 3853860216948489603,  -2882676428710372487, -1003184483360529066, \
			-3390237098588764807, 8105881779000094569,  8456426333562676465,  7073131713139401929,  \
			1275762231560254835,  4716163064694853505,  4590445152259473226,  9063407471026768690,  \
			4281781861621880797,  7764843890476644002,  6841079003105915849,  -1395394710475625093, \
			8425069636922329194,  7670268981714416382,  -137416590835696520,  -7843103728491049413, \
			-2915764255482170254, 392373306702688118,   4580947262257792086,  -2686480133868590393, \
			7557111223159986174,  -7368842155458423353, -2276209380670059054, 6632505901007551122,  \
			4096917378269966384,  150175403860198201,   6978570509729640686,  2456756438667502020,  \
			-5275707787434448205, 5117347586820677436,  -4311970594158609853, -5244448382210567888, \
			3344430406660535045,  -450418159900441600,  -5917120888356868033, -3263677875460817464, \
			1870008448822622553,  4075512718533456680,  8037021308607247968,  -8175853648004704780, \
			8281800321643921916,  2625395678554151881,  -3732351682287502365, -571479956899073932,  \
			-8034131577578340665, 6158402710333672042,  -5638347903465626198, -8249007850581264232, \
			277301768861790619,   4948924786263437846,  -7668993312309271886, -6930660374625756457, \
			-140448254062939723,  -7696472852453237791, -3970134012320751136, 8437675222170723455,  \
			8099788963740933967,  6959634189145234615,  -2261300617595538212, -6046856998226521277, \
			-289828183545984007,  7312975653079705836,  2738465424303526667,  4282127786534600935,  \
			-9117992405877783857, -953036814382600577,  -7271667010783724485, -61323178144293679,   \
			6039784399507579947,  7833395903890680862,  6725533138492674261,  -1068441445549991546, \
			-2204783024933257875, -6613675159220822620, -7235512874798933086, -2148214641177436275, \
			2423519253102389161,  -3009108035132288435, 4417371939775088683,  -5501903313514114146, \
			7455504117623939744,  -9027717496018207509, -3731755390627284443, -967801032376477919,  \
			-101717420537339502,  4496386899864846962,  -721267131173433644,  -5408353578895392728, \
			-1480446680370184146, 6714743344444583099,  3714267758861288885,  4409393446828043101,  \
			-4809256516482773110, 6797452245057974627,  -7790553444947545183, 5412942877255944550,  \
			8904289387066251654,  -8506210637659177974, -2555810225320874128, -58269445140993790,   \
			2747632678190343859,  8692470942865914936,  -4379463952184162593, -7426099301687406877, \
			-8478900770284968512, -2451771477878290654, -8989986765239826621, -4865865651519136492, \
			4218791759943918159,  -9048295095125596292, 3078251917821353011,  5068679015214481725,  \
			9075548776018059835,  895373091641931404,   -4232447121263595884, 5619398871236186577,  \
			6282611399658780649,  -5390083835343479854, 3515084737118476360,  8352186923506425260,  \
			-6227929701694962207, -3454496479836024857, 6272818247262394848,  -3282876133295106974, \
			-2627687244485199333, -5605598300505653141, 6548735118223354071,  -4853421779224052676, \
			-3366674743342191155, -4235342456603704381, 7520961154220242300,  -4652490945528984122, \
			-3874580639738504119, 7617285030637331014,  -7285146469998004805, 7830798459511832728,  \
			3398871032266158075,  -3376818439395186363, 390998768875565241                          \
		}                                                                                           \
	}

#endif /* HMAP_RAND_H */
